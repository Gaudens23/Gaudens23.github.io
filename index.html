<!doctypehtml >
< html >
  < tête >
    < meta  charset =' utf-8 ' >
    < meta  name =' viewport ' content =' width=device-width, initial-scale=1, user-scalable=no ' >
    < meta  name =' mobile-web-app-capable ' content =' yes ' >
    < meta  name =' apple-mobile-web-app-capable ' content =' yes ' >
    < style >
      div . espace-info
      {
        index z :  2 ;
        background-color :  rgba ( 255 ,  255 ,  255 ,  0.90 );
        remplissage :  10 px ;
        text-align : center;
       }

      bouton
      {
        largeur :  100 px ;
        hauteur :  35 px ;
        marge :  15 px ;
      }

   </ style >
    < titre > Chiffre Satiata </ titre >
  </ tête >
  < corps >
    < div  id =" superposition " >
      < div  class =" zone-info " >
        < div  id =" infos " > </ div >
        < button  id =" xr-button " désactivé > XR introuvable </ button >
      </ div >
    </ div >
    < type de script  =" module " >
        // Le contenu WebXR ira ici
        // bouton pour démarrer l'expérience XR
        laissez  xrButton  =  document . getElementById ( 'xr-button' ) ;

        // pour contrôler la session xr
        let  xrSession  =  null ;

        // espace de référence utilisé dans une application
        let  xrRefSpace  =  null ;

        // Contexte Canvas OpenGL utilisé pour le rendu
        soit  gl  =  nul ;

        fonction  checkXR ( )
        {
          if  ( ! fenêtre . isSecureContext )  {
            documenter . getElementById ( " avertissement " ) . innerText  =  "WebXR indisponible. Veuillez utiliser un contexte sécurisé" ;
          }
          if  ( navigateur . xr )  {  // vérifie si WebXR est pris en charge
            navigateur . xr . addEventListener ( 'devicechange' ,  checkSupportedState ) ;
            checkSupportedState ( ) ;
          }  autre  {
            documenter . getElementById ( " avertissement " ) . innerText  =  "WebXR indisponible pour ce navigateur" ;
          }
        }
        fonction  checkÉtat pris en charge ( )
        {
          navigateur . xr . isSessionSupported ( 'immersive-ar' ) . then ( ( pris en charge )  =>  {
            si  ( pris en charge )  {
              xrButton . innerHTML  =  'Entrez AR' ;
              xrButton . addEventListener ( 'clic' ,  onButtonClicked ) ;
            }  autre  {
              xrButton . innerHTML  =  'AR non trouvé' ;
            }
            xrButton . désactivé  =  ! pris en charge ;
          } ) ;
        }

        fonction  onButtonClicked ( )
        {
          si  ( ! xrSession )  {
              navigateur . xr . requestSession ( 'immersive-ar' ,  {
                  optionnelFeatures : [ 'dom-overlay' ] ,
                  Caractéristiques requises : [ 'local' ] ,
                  domOverlay : { racine : document . getElementById ( 'superposition' ) }
              } ) . then ( onSessionStarted ,  onRequestSessionError ) ;
          }  autre  {
            xrSession . fin ( ) ;
          }
        }

        fonction  onSessionStarted ( session )
        {
          xrSession  =  session ;
          xrButton . innerHTML  =  'Quitter AR' ;

          // Afficher le type de superposition DOM activé (le cas échéant)
          if  ( session . domOverlayState )  {
            documenter . getElementById ( 'info' ) . innerHTML  =  'Type de superposition DOM : '  +  session . domOverlayState . taper ;
          }

          séance . addEventListener ( 'fin' ,  onSessionEnded ) ;
          // crée un élément canvas et un contexte WebGL pour le rendu
          let  canvas  =  document . createElement ( 'canvas' ) ;
          gl  =  toile . getContext ( 'webgl' ,  {  xrCompatible : true  } ) ;
          séance . updateRenderState ( {  baseLayer : nouveau  XRWebGLLayer ( session ,  gl )  } ) ;

          séance . requestReferenceSpace ( 'local' ) . then ( ( refSpace )  =>  {
            xrEspaceRéf  =  EspaceRéf ;
            // démarre la boucle de rendu WebXR
            séance . requestAnimationFrame ( onXRFrame ) ;
          } ) ;

        }

        fonction  onRequestSessionError ( ex )
        {
          documenter . getElementById ( 'info' ) . innerHTML  =  "Impossible de démarrer la session AR." ;
        }

        fonction  onSessionEnded ( événement )
        {
          xrSession  =  null ;
          xrButton . innerHTML  =  'Entrez AR' ;
          documenter . getElementById ( 'info' ) . interneHTML  =  '' ;
          gl  =  nul ;
        }

        fonction  onXRFrame ( t ,  frame )
        {
          let  session  =  frame . séance ;
          séance . requestAnimationFrame ( onXRFrame ) ;
          laissez  poser  =  cadre . getViewerPose ( xrRefSpace ) ;
          si  ( ! pose )  {
            retour ;
          }
          const  pos  =  pose . transformer . poste ;
          infos . innerHTML  =  `x : ${ pos . x . toFixed ( 2 ) } y : ${ pos . oui . toFixed ( 2 ) } z : ${ pos . z . toFixed ( 2 ) } ` ;
        }



    </ script >
  </ corps >
</ html >
